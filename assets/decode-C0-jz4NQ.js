var U=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],g=t=>{let e=0;for(let r=0;r<t.length;r++){let a=t[r],o=U.indexOf(a);e=e*83+o}return e},w=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},p=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},y=t=>t<0?-1:1,x=(t,e)=>y(t)*Math.pow(Math.abs(t),e),E=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},H=t=>{if(!t||t.length<6)throw new E("The blurhash string must be at least 6 characters");let e=g(t[0]),r=Math.floor(e/9)+1,a=e%9+1;if(t.length!==4+2*a*r)throw new E(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*a*r}`)},P=t=>{let e=t>>16,r=t>>8&255,a=t&255;return[w(e),w(r),w(a)]},T=(t,e)=>{let r=Math.floor(t/361),a=Math.floor(t/19)%19,o=t%19;return[x((r-9)/9,2)*e,x((a-9)/9,2)*e,x((o-9)/9,2)*e]},B=(t,e,r,a)=>{H(t),a=a|1;let o=g(t[0]),f=Math.floor(o/9)+1,h=o%9+1,i=(g(t[1])+1)/166,s=new Array(h*f);for(let n=0;n<s.length;n++)if(n===0){let l=g(t.substring(2,6));s[n]=P(l)}else{let l=g(t.substring(4+n*2,6+n*2));s[n]=T(l,i*a)}let c=e*4,u=new Uint8ClampedArray(c*r);for(let n=0;n<r;n++)for(let l=0;l<e;l++){let v=0,A=0,C=0;for(let M=0;M<f;M++)for(let m=0;m<h;m++){let d=Math.cos(Math.PI*l*m/e)*Math.cos(Math.PI*n*M/r),b=s[m+M*h];v+=b[0]*d,A+=b[1]*d,C+=b[2]*d}let D=p(v),L=p(A),R=p(C);u[4*l+0+n*c]=D,u[4*l+1+n*c]=L,u[4*l+2+n*c]=R,u[4*l+3+n*c]=255}return u},F=B;const I=4;function O(t,e,r){const a=e*I,o=r*I,f=F(t,a,o),h=document.createElement("canvas");h.width=a,h.height=o;const i=h.getContext("2d");if(!i)return;const s=i.createImageData(a,o);return s.data.set(f),i.putImageData(s,0,0),h.toDataURL("image/png")}export{O as decode2url};
